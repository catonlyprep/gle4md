<script type="text/javascript">
//Parses GLE-specific parameters
gle_set   = typeof pageQuery.parset !== "undefined" ? pageQuery.parset     : "20_8_sc";
gle_p     = typeof pageQuery.nbeads !== "undefined" ? pageQuery.nbeads  : "4";

xset=gle_set.split("_"); 
gle_hwkt=xset[0]; gle_ns=xset[1];

gle_temp  = typeof pageQuery.temp    !== "undefined" ? pageQuery.temp   : 300;
gle_utemp = typeof pageQuery.utemp   !== "undefined" ? pageQuery.utemp  : "k";

DESC="# Generated at http://cosmo-epfl.github.io/gle4md \n\
# Please cite: \n\
# V. Kapil, J. Behler and M. Ceriotti, J. Chem. Phys. 145, 234103 (2016) \n\
# M. Ceriotti, G. Bussi and M. Parrinello, J. Chem. Theory Comput. 6, 1170 (2010) \n\
# M. Ceriotti, G. Bussi and M. Parrinello, Phys. Rev. Lett. 103, 030603 (2009) \n\
# SCPI+GLE parameters. Accelerate convergence of Suzuki-Chin path integral dynamics. \n\
# Use for simulations with $gle_p beads, using a RPMD (physical masses) representation \n\
# of the path and finite-differences SC propagator. \n\
# The parameters were picked from \n\
# "+libroot+"pigle-sc/pigle-"+gle_p+"_"+gle_set+".[ac], \n\
# and shifted so that correspond to quantum fluctuations at \n\
# T="+gle_temp+" "+unitname(gle_utemp)+" \n\
# and that they span a range up to \n\
# &omega;max="+(gle_hwkt*conv_u2i(gle_temp,gle_utemp,"nrg")*0.69503559/Math.sqrt(1+(gle_p/gle_hwkt)*(gle_p/gle_hwkt)))+"&nbsp;cm^-1 \n\
";

HELP="\
      Suzuki-Chin PIMD + GLE parameters. Note that ZPE leakage may be more severe than with PI+GLE or PIGLET\n\
";

</script>

<div class='label'>Par. set</div>&nbsp;<select name="parset" onchange='this.form.submit()'>
<script type="text/javascript"> 
mkOption(gle_set,"20_8_sc","Ns=8, &#8463;&omega;/kT=20");
mkOption(gle_set,"50_8_sc","Ns=8, &#8463;&omega;/kT=50");
mkOption(gle_set,"100_8_sc","Ns=8, &#8463;&omega;/kT=100");
mkOption(gle_set,"101_8_sc","Ns=8, &#8463;&omega;/kT=101");
mkOption(gle_set,"200_8_sc","Ns=8, &#8463;&omega;/kT=200");
mkOption(gle_set,"500_8_sc","Ns=8, &#8463;&omega;/kT=500");
</script>
</select><br/>
<div class='label'>N. beads</div>&nbsp;<select name="nbeads" onchange='this.form.submit()'>
<script type="text/javascript">
   var beadl = [ 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 16, 24, 32, 48, 64 ];
   pfound = false;
   for (i=0; i<beadl.length; ++i) // checks if a matrix file for this number of beads is available
   {
      document.write("beadl "+beadl[i]);
      if ( httpExists(libroot+"pigle-sc/pigle-"+beadl[i]+"_"+gle_set+".a") ) 
      {
         if (gle_p == "") gle_p=beadl[i];
         if (gle_p == beadl[i]) pfound=true;
         mkOption(gle_p,beadl[i],beadl[i]);
      }
   }
   if (!pfound) gle_p = beadl[beadl.length-1];
</script>

</select><br/>
<script type="text/javascript">
mkField(gle_temp,"temp","Target T",gle_utemp,"nrg");
</script>

<b>Max. physical frequency within range:</b><br>
<script type="text/javascript">
document.write("\n&omega;max="+(gle_hwkt*conv_u2i(gle_temp,gle_utemp,"nrg")*0.69503559)+"&nbsp;cm^-1");
</script>

<script type="text/javascript">
gle_itemp=conv_u2i(gle_temp,gle_utemp,"nrg"); 
AMAT=readMatrix(libroot+"pigle-sc/pigle-"+gle_p+"_"+gle_set+".a", gle_itemp*0.13092049*gle_hwkt); 
CMAT=readMatrix(libroot+"pigle-sc/pigle-"+gle_p+"_"+gle_set+".c", gle_itemp); 
</script>
