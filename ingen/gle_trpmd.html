<script type="text/javascript">

// reads GET parameters and sets defaults
gle_set    = typeof pageQuery.parset!== "undefined" ? pageQuery.parset  : "1_jcp2017C";
gle_p      = typeof pageQuery.nbeads!== "undefined" ? pageQuery.nbeads  : 32;
multi_mat=gle_p;

xset=gle_set.split("_"); 
gle_ns=xset[0]; extra=xset[2];

gle_temp    = typeof pageQuery.temp     !== "undefined" ? pageQuery.temp     : 300;
gle_utemp   = typeof pageQuery.utemp    !== "undefined" ? pageQuery.utemp    : "k";


DESC=" \
# Generated at http://cosmo-epfl.github.io/gle4md\n\
# Please cite:\n\
# M. Rossi, V. Kapil, M. Ceriotti, J. Chem. Phys. (2017) \n\
# TRPMD+GLE parameters. Designed to minimize spurious coupling on high-frequency stretches and bends.\n\
# Use for simulations with "+(gle_p)+" beads, using a RPMD (physical masses) representation\n\
# of the path.\n\
# The parameters were picked from\n\
# "+libroot+"trpmd/trpmd-"+gle_set+".a, \n\
# and shifted to match free ring-polymer modes at \n\
# T="+gle_temp+" "+unitname(gle_utemp)+".\n\
";

HELP="TRPMD-GLE: minimize dynamical disturbance in RPMD-like simulations \n\
     of quantum dynamics <br/>"
</script>

<div class='label'>Parameter set</div>&nbsp;<select name="parset" onchange='this.form.submit()'>
<script type="text/javascript">
mkOption(gle_set,"1_jcp2017C","JCP2017(C) exponential-like damping");
mkOption(gle_set,"1_jcp2017D","JCP2017(D) overdamped WN-like");
</script>
</select><br/>
<br/>

<script type="text/javascript">
mkFieldNoUnit(gle_p,"nbeads","Beads number");
</script><br/>

<script type="text/javascript">
mkField(gle_temp,"temp","Target T",gle_utemp,"nrg");
</script>

<script type="text/javascript">
// reads matrix data from library
//now computes the matrices
a1 = readMatrix(libroot+"trpmd/trpmd-"+gle_set+".a", 1);  

// centroid matrix A (exceedingly weak Langevin)
AMAT=[];
AMAT[0]=[];
for (i=0; i<=gle_ns; ++i)
{  
   AMAT[0][i]=[];
   for (j=0; j<=gle_ns; ++j) AMAT[0][i][j]=0.0; 
   AMAT[0][i][i]=1e-40; 
}

gle_itemp=conv_u2i(gle_temp,gle_utemp,"nrg");
// bead matrices A
for (b=1; b<gle_p; ++b) 
{
    // remember that "internal" units are ps and k, so we convert to atomic units and then to THz
    wb = 2*gle_p*gle_itemp*6579.6839*6.2831853/315774.67*Math.sin(b*Math.PI/gle_p)
    AMAT[b]=[];
    for (i=0; i<=gle_ns; ++i)
    {  
       AMAT[b][i]=[];
       for (j=0; j<=gle_ns; ++j) AMAT[b][i][j]=a1[i][j]*wb; 
    }
}

// no C matrix for TRPMD
CMAT = ""
</script>
